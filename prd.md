# 作文素材打磨器 - 设计方案 (MVP版)

## 一、项目背景与目标

### 1.1 背景
针对中学生中考作文备考需求，设计一个AI辅助的作文素材打磨工具。通过对近十年北京中考作文题目的分析，帮助学生：
- 理解中考作文评分标准
- 将个人经历转化为高分素材
- 实现"一材多用"的灵活应用

### 1.2 目标用户
- **主要用户**：初中学生（13-15岁）
- **使用场景**：作文备考、素材整理、写作训练

### 1.3 MVP版本范围
**第一期只实现核心功能：**
1. ✅ 素材录入与分类
2. ✅ AI评分与诊断
3. ✅ 一材多用生成

**后续版本添加：**
- 深度拓宽（历史同构、时代共鸣）
- 金句适配器
- 历年真题库
- 范文参考

---

## 二、界面设计 Demo（MVP版）

### 2.1 界面一：首页（素材输入）

```
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃  📝 作文素材打磨器                                    [设置] [关于]  ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                                                       ┃
┃  ┌─────────────────────────────────────────────────────────────────┐  ┃
┃  │                                                                 │  ┃
┃  │     欢迎来到作文素材打磨器 👋                                   │  ┃
┃  │                                                                 │  ┃
┃  │     把你的日记、随笔或作文片段粘贴在这里，                       │  ┃
┃  │     AI老师会帮你评分、提建议，还能帮你把一个素材                 │  ┃
┃  │     变成适合不同作文题目的版本！                                 │  ┃
┃  │                                                                 │  ┃
┃  │  ┌─────────────────────────────────────────────────────────┐   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  │  示例：上周六我去参加了学校组织的植树活动。早上八点      │   │  ┃
┃  │  │  我们在校门口集合，然后坐大巴去了郊区。到了那里，        │   │  ┃
┃  │  │  我们每个人领了一棵小树苗开始挖坑种树。虽然很累，        │   │  ┃
┃  │  │  但是看到种好的树很有成就感...                           │   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  └─────────────────────────────────────────────────────────┘   │  ┃
┃  │                                                                 │  ┃
┃  │  选择分类： ▼ 个体经验      添加标签：[植树] [劳动] [成长] ➕  │  ┃
┃  │                                                                 │  ┃
┃  │           ┌──────────────────┐                                 │  ┃
┃  │           │   🔍 开始打磨    │                                 │  ┃
┃  │           └──────────────────┘                                 │  ┃
┃  │                                                                 │  ┃
┃  └─────────────────────────────────────────────────────────────────┘  ┃
┃                                                                       ┃
┃  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  ┃
┃  💡 小贴士：好的素材要有具体的时间、地点、人物和细节描写             ┃
┃                                                                       ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

**界面说明：**
- 大文本框：用户粘贴自己的素材（日记、随笔、作文片段）
- 分类下拉：选择素材所属类别（个体经验、运动健康、社会实践等）
- 标签：可添加多个关键词标签，方便后续查找
- 绿色按钮：点击后进入AI分析流程

---

### 2.2 界面二：AI评分结果

```
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃  📝 作文素材打磨器                                    [设置] [关于]  ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                                                       ┃
┃     Step 1          Step 2          Step 3                           ┃
┃     ┌────┐    ┏━━━━┓    ┌────┐                                       ┃
┃     │ ✓  │════┃ 📊 ┃════│ 🔄 │                                       ┃
┃     └────┘    ┗━━━━┛    └────┘                                       ┃
┃     输入素材    AI评分    一材多用                                    ┃
┃                                                                       ┃
┃  ┌─────────────────────────────────────────────────────────────────┐  ┃
┃  │  📊 AI 评分报告                                                  │  ┃
┃  │                                                                 │  ┃
┃  │  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐   │  ┃
┃  │  │  内容完整度      │ │  细节丰富度      │ │  情感真挚度      │   │  ┃
┃  │  │                 │ │                 │ │                 │   │  ┃
┃  │  │    ⭐⭐⭐⭐☆     │ │    ⭐⭐⭐☆☆     │ │    ⭐⭐⭐⭐☆     │   │  ┃
┃  │  │     4.0/5.0     │ │     3.0/5.0     │ │     4.0/5.0     │   │  ┃
┃  │  │    事件完整     │ │   缺少感官细节  │ │    情感真实     │   │  ┃
┃  │  └─────────────────┘ └─────────────────┘ └─────────────────┘   │  ┃
┃  │                                                                 │  ┃
┃  │  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓   │  ┃
┃  │  ┃  💡 综合评分：3.7/5.0                                    ┃   │  ┃
┃  │  ┃                                                        ┃   │  ┃
┃  │  ┃  总体评价：这是一个结构完整、情感真实的素材，但缺少     ┃   │  ┃
┃  │  ┃  具体的感官细节描写，导致画面感不够强。                 ┃   │  ┃
┃  │  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛   │  ┃
┃  │                                                                 │  ┃
┃  │  📝 改进建议：                                                   │  ┃
┃  │  ┌─────────────────────────────────────────────────────────┐   │  ┃
┃  │  │ 1. 补充挖坑时的身体感受：泥土的湿度、铁锹的重量、手心   │   │  ┃
┃  │  │    是否磨出了水泡...                                    │   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  │ 2. 加入环境描写：当天的天气、郊区的风景、树苗的样子     │   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  │ 3. 描写心理变化：从一开始的不情愿到后来的成就感         │   │  ┃
┃  │  │    的过程                                               │   │  ┃
┃  │  └─────────────────────────────────────────────────────────┘   │  ┃
┃  │                                                                 │  ┃
┃  │           ┌──────────────────┐    ┌──────────────────┐        │  ┃
┃  │           │   ← 重新输入     │    │  查看一材多用 →  │        │  ┃
┃  │           └──────────────────┘    └──────────────────┘        │  ┃
┃  │                                                                 │  ┃
┃  └─────────────────────────────────────────────────────────────────┘  ┃
┃                                                                       ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

**界面说明：**
- 三个维度评分：用星星直观展示（满分5星）
- 综合评分：计算总分并给出总体评价
- 改进建议：AI逐条列出具体的改进方向
- 两个按钮：可以返回修改，或继续看一材多用结果

---

### 2.3 界面三：一材多用生成

```
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃  📝 作文素材打磨器                                    [设置] [关于]  ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                                                       ┃
┃     Step 1          Step 2          Step 3                           ┃
┃     ┌────┐         ┌────┐         ┏━━━━┓                             ┃
┃     │ ✓  │═════════│ ✓  │═════════┃ 🔄 ┃                             ┃
┃     └────┘         └────┘         ┗━━━━┛                             ┃
┃     输入素材        AI评分        一材多用                            ┃
┃                                                                       ┃
┃  ┌─────────────────────────────────────────────────────────────────┐  ┃
┃  │  🔄 一材多用：同一个素材，多种用法                               │  ┃
┃  │                                                                 │  ┃
┃  │  原始素材：[植树活动]                                            │  ┃
┃  │  ┌─────────────────────────────────────────────────────────┐   │  ┃
┃  │  │ 上周六参加学校组织的植树活动，虽然累但很有成就感...      │   │  ┃
┃  │  └─────────────────────────────────────────────────────────┘   │  ┃
┃  │                                                                 │  ┃
┃  │  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓   │  ┃
┃  │  ┃  🌱 角度一：劳动/成长                                     ┃   │  ┃
┃  │  ┃  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  ┃   │  ┃
┃  │  ┃  适配题目：《那一次，我懂得了____》《劳动的快乐》         ┃   │  ┃
┃  │  ┃                                                        ┃   │  ┃
┃  │  ┃  💡 写法建议：                                           ┃   │  ┃
┃  │  ┃ 重点写"手磨出水泡想放弃→看到成片的树苗→理解劳动意义"    ┃   │  ┃
┃  │  ┃ 的情感变化过程，突出"成长"主题。                         ┃   │  ┃
┃  │  ┃                                                        ┃   │  ┃
┃  │  ┃  📝 片段示例：                                           ┃   │  ┃
┃  │  ┃ "铁锹一次次铲进坚硬的泥土，我的手心火辣辣地疼。看着     ┃   │  ┃
┃  │  ┃  旁边同学满头大汗却还在坚持，我咬咬牙又挖了下去..."      ┃   │  ┃
┃  │  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛   │  ┃
┃  │                                                                 │  ┃
┃  │  ┌─────────────────────────────────────────────────────────┐   │  ┃
┃  │  │  🌿 角度二：环保/责任                                     │   │  ┃
┃  │  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │   │  ┃
┃  │  │  适配题目：《绿色生活》《我为环保做贡献》                 │   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  │  💡 写法建议：                                           │   │  ┃
┃  │  │ 把树苗和未来联系起来，写"种下的不只是树，更是对地球的    │   │  ┃
┃  │  │  一份承诺"，升华到环保责任意识。                         │   │  ┃
┃  │  └─────────────────────────────────────────────────────────┘   │  ┃
┃  │                                                                 │  ┃
┃  │  ┌─────────────────────────────────────────────────────────┐   │  ┃
┃  │  │  🤝 角度三：团队/合作                                     │   │  ┃
┃  │  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │   │  ┃
┃  │  │  适配题目：《我们在一起》《团结的力量》                   │   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  │  💡 写法建议：                                           │   │  ┃
┃  │  │ 重点写和同学配合挖坑、培土的过程，突出"一个人挖很累，    │   │  ┃
┃  │  │  但两个人配合就轻松多了"的协作体验。                     │   │  ┃
┃  │  └─────────────────────────────────────────────────────────┘   │  ┃
┃  │                                                                 │  ┃
┃  │  ┌─────────────────────────────────────────────────────────┐   │  ┃
┃  │  │  ⏰ 角度四：坚持/毅力                                     │   │  ┃
┃  │  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │   │  ┃
┃  │  │  适配题目：《坚持就是胜利》《那一刻，我战胜了自己》       │   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  │  💡 写法建议：                                           │   │  ┃
┃  │  │ 聚焦最累想放弃的那一刻，以及是什么让你坚持了下来，       │   │  ┃
┃  │  │  可能是同学的鼓励，也可能是内心的不甘。                 │   │  ┃
┃  │  └─────────────────────────────────────────────────────────┘   │  ┃
┃  │                                                                 │  ┃
┃  │  ┌──────────────────┐    ┌──────────────────┐                  │  ┃
┃  │  │   ← 返回评分     │    │  保存到我的素材  │                  │  ┃
┃  │  └──────────────────┘    └──────────────────┘                  │  ┃
┃  │                                                                 │  ┃
┃  └─────────────────────────────────────────────────────────────────┘  ┃
┃                                                                       ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

**界面说明：**
- 每个角度一个卡片，展示4个不同切入方向
- 每个卡片包含：角度名称、适配题目、写法建议、片段示例
- 用户可以直接复制示例片段，或在此基础上修改
- 保存后素材会存入"我的素材库"

---

### 2.4 界面四：我的素材库

```
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃  📝 作文素材打磨器                                    [设置] [关于]  ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                                                       ┃
┃  📚 我的素材库                                                        ┃
┃                                                                       ┃
┃  筛选： [全部 ▼]  搜索：🔍 _________________                          ┃
┃                                                                       ┃
┃  ┌─────────────────────────────────────────────────────────────────┐  ┃
┃  │  🌱 植树活动                                            3天前   │  ┃
┃  │  #劳动 #成长 #环保                                                │  ┃
┃  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━    │  ┃
┃  │  评分：⭐⭐⭐⭐☆ 3.7/5.0   |   4个使用角度                        │  ┃
┃  │  [查看详情]  [编辑]  [复制]  [删除]                                │  ┃
┃  └─────────────────────────────────────────────────────────────────┘  ┃
┃                                                                       ┃
┃  ┌─────────────────────────────────────────────────────────────────┐  ┃
┃  │  🏀 篮球比赛                                            1周前   │  ┃
┃  │  #运动 #团队 #坚持                                                │  ┃
┃  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━    │  ┃
┃  │  评分：⭐⭐⭐⭐☆ 4.2/5.0   |   5个使用角度                        │  ┃
┃  │  [查看详情]  [编辑]  [复制]  [删除]                                │  ┃
┃  └─────────────────────────────────────────────────────────────────┘  ┃
┃                                                                       ┃
┃  ┌─────────────────────────────────────────────────────────────────┐  ┃
┃  │  🎨 学画国画                                            2周前   │  ┃
┃  │  #艺术 #传统文化 #坚持                                            │  ┃
┃  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━    │  ┃
┃  │  评分：⭐⭐⭐⭐⭐ 4.5/5.0   |   3个使用角度                        │  ┃
┃  │  [查看详情]  [编辑]  [复制]  [删除]                                │  ┃
┃  └─────────────────────────────────────────────────────────────────┘  ┃
┃                                                                       ┃
┃                        ┌──────────────────┐                           ┃
┃                        │    + 添加新素材   │                           ┃
┃                        └──────────────────┘                           ┃
┃                                                                       ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

**界面说明：**
- 列表展示所有保存的素材
- 每个素材显示：标题、标签、评分、角度数量、操作时间
- 支持筛选、搜索、编辑、删除

---

## 三、功能架构设计

### 3.1 核心功能流程

```
┌─────────────────────────────────────────────────────────────────────────┐
│                           MVP功能流程                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   ┌──────────────┐      ┌──────────────┐      ┌──────────────┐         │
│   │              │      │              │      │              │         │
│   │  1. 输入素材  │─────→│  2. AI 评分   │─────→│ 3. 一材多用  │         │
│   │              │      │              │      │              │         │
│   └──────────────┘      └──────────────┘      └──────────────┘         │
│          │                     │                     │                 │
│          ▼                     ▼                     ▼                 │
│   ┌──────────────┐      ┌──────────────┐      ┌──────────────┐         │
│   │ • 粘贴文本    │      │ • 内容完整度  │      │ • 劳动/成长   │         │
│   │ • 选择分类    │      │ • 细节丰富度  │      │ • 环保/责任   │         │
│   │ • 添加标签    │      │ • 情感真挚度  │      │ • 团队/合作   │         │
│   │              │      │ • 改进建议    │      │ • 坚持/毅力   │         │
│   └──────────────┘      └──────────────┘      └──────────────┘         │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

---

---

## 四、分类系统设计（关键改进）

### 4.1 设计理念：动态分类 + 用户知识注入

**问题**：预设分类缺乏真题支撑，无法反映中考实际命题规律。

**解决方案**：
1. **基础分类**：提供通用的 starter 分类（基于常见作文主题）
2. **知识导入接口**：用户可以上传.md/.pdf文件，导入真题分析资料
3. **AI动态学习**：AI基于导入的资料自动更新分类体系和评判标准

### 4.2 数据结构：三层分类体系

```javascript
// ========== 第一层：基础分类（Starter）==========
// 基于通用作文主题，应用启动时自带
const BASE_CATEGORIES = {
  version: "1.0",
  source: "starter",
  lastUpdated: "2024-01-01",

  // 通用主题（不依赖具体真题）
  themes: [
    { id: 'growth', name: '成长感悟', description: '个人成长、克服困难、自我突破' },
    { id: 'emotion', name: '情感体验', description: '亲情、友情、师生情、人间温暖' },
    { id: 'quality', name: '品质修养', description: '诚信、坚持、责任、勇气' },
    { id: 'culture', name: '文化传承', description: '传统文化、家国情怀、文化自信' },
    { id: 'society', name: '社会观察', description: '社会现象、时代变迁、人文关怀' },
    { id: 'nature', name: '自然感悟', description: '自然景观、环境保护、生命思考' }
  ],

  // 通用标签库
  tags: ['坚持', '成长', '亲情', '友情', '传统文化', '责任', '环保', '创新', '团队', '挫折']
};

// ========== 第二层：真题知识库（用户导入）==========
const EXAM_KNOWLEDGE = {
  // 北京中考真题库
  beijing: {
    enabled: false,  // 用户导入后启用
    source: "用户导入", // 文件名
    data: {
      years: ['2015','2016','2017','2018','2019','2020','2021','2022','2023','2024'],
      // 真题数据（用户导入）
      topics: [
        { year: 2024, title: "_____,让我快乐", type: "半命题", theme: "情感体验" },
        // ... 更多题目
      ],
      // 高频主题统计（AI分析生成）
      stats: {
        topThemes: ['情感体验', '成长感悟', '品质修养'],
        keywordFrequency: { '成长': 15, '快乐': 12, '坚持': 10 }
      }
    }
  },

  // 可以添加其他地区
  shanghai: { enabled: false, data: {} },
  custom: { enabled: false, data: {} }  // 用户自定义
};

// ========== 第三层：AI动态分析 ===========
const AI_ANALYSIS = {
  // AI基于真题库生成的洞察
  insights: {
    // 命题趋势
    trends: "近5年北京中考作文主题分布...",

    // 高分要素
    highScoreFactors: [
      "真情实感 > 华丽辞藻",
      "具体细节 > 空洞抒情",
      "个人体验 > 套用范文"
    ],

    // 主题关联图谱（用于一材多用）
    themeConnections: {
      '植树活动': ['成长感悟', '环保意识', '团队协作'],
      '学骑自行车': ['成长感悟', '坚持品质', '克服困难']
    }
  }
};

// ========== 运行时合并后的分类 ===========
const ACTIVE_CATEGORIES = {
  // 合并基础分类 + 真题驱动的分类
  themes: [...BASE_CATEGORIES.themes, /* 真题分析添加的 */],

  // 评分标准（可被真题知识覆盖）
  scoringCriteria: {
    // 基础标准
    base: { completeness: 0.3, detail: 0.4, authenticity: 0.3 },
    // 真题分析后的优化标准
    optimized: null // 用户导入后AI生成
  }
};
```

### 4.3 知识导入功能设计

```
┌─────────────────────────────────────────────────────────────────┐
│  📚 知识库管理                                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  【当前状态】                                                     │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 基础分类 ✅ 已启用                                        │    │
│  │ 北京中考真题库 ⏳ 未导入（推荐导入以提升AI准确性）         │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  【导入资料】                                                     │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                                                         │    │
│  │  📄 支持格式：Markdown (.md) 或 PDF (.pdf)              │    │
│  │                                                         │    │
│  │  📋 建议包含内容：                                       │    │
│  │     • 历年中考作文题目列表                               │    │
│  │     • 题目类型（命题/半命题/材料作文）                    │    │
│  │     • 优秀范文示例                                       │    │
│  │     • 评分标准解读                                       │    │
│  │     • 高分要素分析                                       │    │
│  │                                                         │    │
│  │     [选择文件...]  支持拖拽上传                         │    │
│  │                                                         │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  【AI学习】                                                       │
│  导入后AI将自动：                                                  │
│  • 分析真题主题分布和命题趋势                                      │
│  • 提取高频关键词和评分标准                                        │
│  • 优化素材分类体系                                                │
│  • 更新"一材多用"的推荐逻辑                                        │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  📊 导入示例：北京中考作文分析.md                         │    │
│  │                                                         │    │
│  │  内容预览：                                              │    │
│  │  ## 2024年北京中考作文                                   │    │
│  │  题目：______，让我快乐                                  │    │
│  │  类型：半命题作文                                         │    │
│  │  主题倾向：情感体验、个人成长                              │    │
│  │  高分要点：真情实感、细节描写                              │    │
│  │                                                         │    │
│  │              [开始AI分析 →]                              │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 4.4 AI Prompt更新：支持知识库

```javascript
// 动态构建Prompt，注入知识库
function buildPrompt(type, content) {
  // 获取当前启用的知识
  const knowledge = getActiveKnowledge();

  const basePrompt = `你是一位资深中考作文阅卷老师，有20年阅卷经验。`;

  // 如果有真题知识，注入Prompt
  const knowledgePrompt = knowledge.enabled ? `
【北京中考真题知识库】
近10年高频主题：${knowledge.stats.topThemes.join('、')}
命题趋势：${knowledge.trends}
高分要素：${knowledge.highScoreFactors.join('\n')}
` : '';

  const taskPrompt = type === 'score' ? `
请对以下素材进行评分（满分5分）：
1. 内容完整度
2. 细节丰富度
3. 情感真挚度

素材：${content}
` : `
请针对以下素材，生成3-4个不同的作文立意角度。
参考北京中考常见主题：${knowledge.themes?.join('、') || '成长、情感、品质、文化、社会、自然'}

素材：${content}
`;

  return basePrompt + knowledgePrompt + taskPrompt;
}
```

### 4.5 用户素材数据结构

```javascript
const USER_MATERIAL = {
  id: "uuid",
  title: "素材标题",
  content: "原始素材内容",

  // 分类（基于当前激活的分类体系）
  category: "成长感悟",
  aiMatchedCategories: ["成长感悟", "品质修养"], // AI根据内容匹配

  tags: ["植树","劳动","成长"],
  createdAt: "timestamp",

  // AI评分结果（基于当前知识库的评分标准）
  scores: {
    completeness: 4,    // 内容完整度
    detail: 3,          // 细节丰富度
    authenticity: 4,    // 情感真挚度
    overall: 3.7
  },
  suggestions: ["建议1", "建议2", "建议3"],

  // 一材多用结果（基于真题库的主题推荐）
  pivots: [
    {
      dimension: "劳动/成长",
      themes: ["成长感悟", "品质修养"], // 对应分类体系
      topics: ["那一次，我懂得了____", "劳动的快乐"],
      advice: "重点写情感变化过程",
      example: "片段示例文本"
    }
  ],

  // 关联的真题（AI推荐）
  relatedExamQuestions: [
    { year: 2023, title: "_____，让我快乐", relevance: 0.85 }
  ]
};
```

---

## 五、新增界面：知识库管理

### 5.1 界面五：知识库导入与AI学习

```
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃  📝 作文素材打磨器                                    [设置] [关于]  ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                                                       ┃
┃  📚 知识库管理                                                        ┃
┃                                                                       ┃
┃  ┌─────────────────────────────────────────────────────────────────┐  ┃
┃  │  【当前知识库状态】                                               │  ┃
┃  │                                                                 │  ┃
┃  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │  ┃
┃  │  │  基础分类    │  │  北京中考    │  │  上海中考    │             │  ┃
┃  │  │    ✅       │  │    ⏳       │  │    ⏳       │             │  ┃
┃  │  │   已启用    │  │   未导入    │  │   未导入    │             │  ┃
┃  │  └─────────────┘  └─────────────┘  └─────────────┘             │  ┃
┃  │                                                                 │  ┃
┃  │  状态说明：                                                       │  ┃
┃  │  • 基础分类：通用作文主题，无需导入即可使用                        │  ┃
┃  │  • 北京中考：导入历年真题后，AI将基于真题优化分析和推荐            │  ┃
┃  │  • 上海中考：可添加其他地区真题                                   │  ┃
┃  │                                                                 │  ┃
┃  └─────────────────────────────────────────────────────────────────┘  ┃
┃                                                                       ┃
┃  ┌─────────────────────────────────────────────────────────────────┐  ┃
┃  │  【导入北京中考真题资料】                                         │  ┃
┃  │                                                                 │  ┃
┃  │  📋 推荐导入内容：                                                │  ┃
┃  │     • 2015-2024年北京中考作文题目                                 │  ┃
┃  │     • 题目类型、评分标准、高分范文                                │  ┃
┃  │     • 命题趋势分析、主题分布统计                                  │  ┃
┃  │                                                                 │  ┃
┃  │  📄 支持格式：Markdown (.md) / PDF (.pdf) / TXT (.txt)            │  ┃
┃  │                                                                 │  ┃
┃  │  ┌─────────────────────────────────────────────────────────┐   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  │           拖拽文件到此处 或 点击选择文件                  │   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  │           📄 北京中考作文分析.md                         │   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  └─────────────────────────────────────────────────────────┘   │  ┃
┃  │                                                                 │  ┃
┃  │  文件预览（前500字）：                                            │  ┃
┃  │  ┌─────────────────────────────────────────────────────────┐   │  ┃
┃  │  │ ## 北京中考作文题目汇总 (2015-2024)                      │   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  │ ### 2024年                                              │   │  ┃
┃  │  │ 题目：_____，让我快乐                                    │   │  ┃
┃  │  │ 类型：半命题作文                                         │   │  ┃
┃  │  │ 主题：情感体验、个人成长                                  │   │  ┃
┃  │  │ ...                                                     │   │  ┃
┃  │  └─────────────────────────────────────────────────────────┘   │  ┃
┃  │                                                                 │  ┃
┃  │           ┌──────────────────┐                                  │  ┃
┃  │           │  🚀 开始AI分析   │                                  │  ┃
┃  │           └──────────────────┘                                  │  ┃
┃  │                                                                 │  ┃
┃  └─────────────────────────────────────────────────────────────────┘  ┃
┃                                                                       ┃
┃  ┌─────────────────────────────────────────────────────────────────┐  ┃
┃  │  【AI分析结果】（导入后显示）                                     │  ┃
┃  │                                                                 │  ┃
┃  │  📊 主题分布统计：                                                │  ┃
┃  │  • 情感体验：35% （12次）                                         │  ┃
┃  │  • 成长感悟：28% （10次）                                         │  ┃
┃  │  • 品质修养：20% （7次）                                          │  ┃
┃  │  • 文化传承：12% （4次）                                          │  ┃
┃  │  • 社会观察：5%  （2次）                                          │  ┃
┃  │                                                                 │  ┃
┃  │  🔑 高频关键词：                                                  │  ┃
┃  │  成长(15次)  快乐(12次)  坚持(10次)  感动(8次)  感恩(7次)          │  ┃
┃  │                                                                 │  ┃
┃  │  💡 AI洞察：                                                      │  ┃
┃  │  近5年北京中考作文呈现"重情感、轻说教"趋势，                     │  ┃
┃  │  更关注学生真实体验而非空洞议论。                                 │  ┃
┃  │                                                                 │  ┃
┃  │  ✅ 已更新素材分类体系                                            │  ┃
┃  │  ✅ 已优化AI评分标准                                              │  ┃
┃  │  ✅ 已更新一材多用推荐逻辑                                        │  ┃
┃  │                                                                 │  ┃
┃  └─────────────────────────────────────────────────────────────────┘  ┃
┃                                                                       ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

**界面说明：**
- 显示当前知识库状态（基础分类/各地真题）
- 支持拖拽上传.md/.pdf/.txt文件
- 文件预览确认内容正确
- AI分析后显示主题分布、关键词统计、AI洞察
- 自动更新分类体系和评分标准

---

## 六、配色方案

```css
:root {
  /* 主色调 - 清新绿 */
  --primary: #4CAF50;
  --primary-light: #81C784;
  --primary-dark: #388E3C;

  /* 辅助色 */
  --secondary: #2196F3;    /* 蓝色 - 用于评分、分析 */
  --accent: #FF9800;       /* 橙色 - 用于强调、标签 */

  /* 中性色 */
  --bg-primary: #FAFAFA;   /* 主背景 */
  --bg-secondary: #F5F5F5; /* 次背景 */
  --surface: #FFFFFF;      /* 卡片表面 */
  --border: #E0E0E0;       /* 边框 */

  /* 文字 */
  --text-primary: #212121;
  --text-secondary: #757575;

  /* 评分颜色 */
  --score-high: #4CAF50;
  --score-mid: #FFC107;
  --score-low: #F44336;
}
```

---

## 六、技术实现方案 (MVP版)

### 6.1 技术栈选择

| 层级 | 技术 | 说明 |
|------|------|------|
| 前端 | 纯 HTML5 + CSS3 + JavaScript | 延续之前项目风格，单文件即可运行 |
| 存储 | LocalStorage | 本地保存用户素材 |
| AI能力 | Claude API | 需要用户自行配置API密钥 |

### 6.2 文件结构

```
try1-0210/
├── index.html              # 主应用（单文件，包含HTML/CSS/JS）
└── prd.md                  # 产品需求文档
```

**MVP版本采用单文件结构**，所有代码都在 `index.html` 中，方便使用和分享。

### 6.3 AI Prompt设计（支持知识库注入）

#### Prompt 1: 分析用户导入的真题资料

```
你是一位中考作文研究专家。请深度分析以下北京中考作文资料：

【资料内容】
{{fileContent}}

请提取并返回以下信息（JSON格式）：
{
  "years": ["2015", "2016", ...],
  "topics": [
    {
      "year": 2024,
      "title": "题目原文",
      "type": "命题/半命题/材料",
      "theme": "主题分类",
      "keywords": ["关键词1", "关键词2"],
      "analysis": "题目分析"
    }
  ],
  "stats": {
    "topThemes": [
      {"name": "主题名", "count": 出现次数, "percentage": "35%"}
    ],
    "keywordFrequency": {"成长": 15, "快乐": 12}
  },
  "trends": "近10年命题趋势总结（100字）",
  "highScoreFactors": ["高分要素1", "高分要素2", "高分要素3"],
  "themeCategories": [
    {"name": "分类名称", "description": "分类定义", "examples": ["示例题目"]}
  ]
}
```

#### Prompt 2: 素材评分（注入真题知识）

```
你是一位资深中考作文阅卷老师，有20年阅卷经验。

{{#if knowledge.enabled}}
【北京中考真题知识库】
近10年高频主题：{{knowledge.stats.topThemes}}
命题趋势：{{knowledge.trends}}
高分要素：{{knowledge.highScoreFactors}}
{{/if}}

请对以下学生作文素材进行评分和分析：

【素材内容】
{{content}}

评分维度（满分5分）：
1. 内容完整度：时间、地点、人物、事件是否清晰
2. 细节丰富度：感官细节（视觉、听觉、触觉）是否到位
3. 情感真挚度：情感是否真实自然

{{#if knowledge.enabled}}
额外要求：
- 分析该素材与北京中考真题的适配度
- 推荐3个最可能适用的中考题目
{{/if}}

返回JSON格式：
{
  "scores": {
    "completeness": 分数,
    "detail": 分数,
    "authenticity": 分数,
    "overall": 综合评分
  },
  "summary": "总体评价",
  "suggestions": ["建议1", "建议2", "建议3"],
  {{#if knowledge.enabled}}
  "examFit": {
    "score": 适配度评分,
    "recommendedTopics": [
      {"year": 2024, "title": "题目", "relevance": 0.85}
    ]
  }
  {{/if}}
}
```

#### Prompt 3: 一材多用（基于真题主题）

```
你是一位中考作文辅导专家。

{{#if knowledge.enabled}}
【北京中考真题知识库】
近10年高频主题：{{knowledge.stats.topThemes}}
主题分布：{{knowledge.stats.themeDistribution}}
{{/if}}

请针对以下素材，生成3-4个不同的作文立意角度。
要求：角度要具体、可操作，能直接用于写作。

【素材内容】
{{content}}

{{#if knowledge.enabled}}
优先参考北京中考高频主题：{{topThemes}}
{{else}}
参考通用主题：成长、情感、品质、文化、社会、自然
{{/if}}

返回JSON格式：
{
  "pivots": [
    {
      "dimension": "角度名称",
      "themes": ["对应主题分类1", "对应主题分类2"],
      "topics": ["适配题目1", "适配题目2"],
      "advice": "写法建议",
      "example": "片段示例"
    }
  ]
}
```

### 6.4 核心代码结构

```javascript
// ========== 应用状态 ==========
const App = {
  currentView: 'input',  // input | score | pivots | library | knowledge
  material: { content: '', category: '', tags: [] },
  result: null,

  showView(view) { ... },
  async scoreMaterial() { ... },
  async generatePivots() { ... },
  saveMaterial() { ... },
  loadLibrary() { ... }
};

// ========== LocalStorage 封装 ==========
const Storage = {
  MATERIALS_KEY: 'essay_materials',
  getMaterials() { return JSON.parse(localStorage.getItem(this.MATERIALS_KEY) || '[]'); },
  setMaterials(data) { localStorage.setItem(this.MATERIALS_KEY, JSON.stringify(data)); },

  KNOWLEDGE_KEY: 'essay_knowledge',
  getKnowledge() { return JSON.parse(localStorage.getItem(this.KNOWLEDGE_KEY) || '{}'); },
  setKnowledge(data) { localStorage.setItem(this.KNOWLEDGE_KEY, JSON.stringify(data)); },

  SETTINGS_KEY: 'essay_settings',
  getSettings() {
    return JSON.parse(localStorage.getItem(this.SETTINGS_KEY) || '{}');
  }
};

// ========== 多AI服务支持 ==========
const AIServices = {
  // 主AI：Claude（素材打磨）
  claude: {
    name: 'Claude',
    apiKey: null,
    async call(prompt) { /* 调用Claude API */ }
  },

  // 搜索AI：DeepSeek/ChatGPT（可选，用于搜索真题）
  searchAI: {
    name: 'DeepSeek', // 可配置
    apiKey: null,
    baseUrl: 'https://api.deepseek.com/v1',
    async search(query) {
      // 使用AI的搜索功能获取真题资料
      const prompt = `请搜索${query}，并整理成结构化数据返回`;
      return await this.call(prompt);
    }
  },

  // 分析真题资料
  async analyzeKnowledgeFile(fileContent) {
    return await this.claude.call(`
你是一位中考作文研究专家。请分析以下资料：
${fileContent}
...返回JSON格式`);
  }
};
```

### 6.5 AI搜索功能设计

```javascript
// 在知识库管理界面添加"AI搜索"功能
const KnowledgeSearch = {
  // 方式1：应用内直接搜索（需要配置搜索AI的API密钥）
  async searchOnline(region = 'beijing', years = '2015-2024') {
    const query = `${region}中考作文题目${years}`;

    // 调用DeepSeek/ChatGPT等支持搜索的AI
    const result = await AIServices.searchAI.search(query);

    // 自动调用Claude分析搜索结果
    const analysis = await AIServices.analyzeKnowledgeFile(result);

    // 保存到知识库
    Storage.setKnowledge({
      [region]: {
        enabled: true,
        source: 'AI搜索',
        data: analysis
      }
    });

    return analysis;
  },

  // 方式2：辅助生成搜索提示词（用户自己去其他AI搜索）
  generateSearchTemplate() {
    return {
      title: '北京中考作文题目汇总（2015-2024）',
      prompt: `请搜索并整理2015-2024年北京中考作文题目，按以下格式返回：

## 2024年
- 题目：_____
- 类型：命题/半命题/材料作文
- 主题倾向：情感/成长/品质等
- 高分要点：

要求：
1. 包含完整的题目原文
2. 分析每道题的主题倾向
3. 统计10年间的主题分布
4. 总结命题趋势和高分要素`,

      copyToClipboard() { /* 复制提示词 */ }
    };
  }
};
```

### 6.6 界面六：AI搜索配置与执行

```
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃  📝 作文素材打磨器                                    [设置] [关于]  ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                                                       ┃
┃  📚 知识库管理  ＞  AI搜索获取真题资料                                ┃
┃                                                                       ┃
┃  ┌─────────────────────────────────────────────────────────────────┐  ┃
┃  │                                                                 │  ┃
┃  │  【方式一：应用内AI搜索（付费便捷）】                            │  ┃
┃  │                                                                 │  ┃
┃  │  选择搜索服务：                                                   │  ┃
┃  │  ○ DeepSeek  ○ ChatGPT  ○ 自定义                                 │  ┃
┃  │                                                                 │  ┃
┃  │  API密钥：    [                                    ] 👁️          │  ┃
┃  │  自定义URL：  [https://api.deepseek.com/v1       ]（可选）       │  ┃
┃  │                                                                 │  ┃
┃  │  搜索范围：                                                       │  ┃
┃  │  地区： ▼ 北京    年份：2015 - 2024                              │  ┃
┃  │                                                                 │  ┃
┃  │  预估费用：约 ¥0.5-2（取决于搜索结果长度）                        │  ┃
┃  │                                                                 │  ┃
┃  │         ┌────────────────────────────────────┐                  │  ┃
┃  │         │  🔍 开始AI搜索并自动分析（2-3分钟） │                  │  ┃
┃  │         └────────────────────────────────────┘                  │  ┃
┃  │                                                                 │  ┃
┃  ├─────────────────────────────────────────────────────────────────┤  ┃
┃  │                         或者                                    │  ┃
┃  ├─────────────────────────────────────────────────────────────────┤  ┃
┃  │                                                                 │  ┃
┃  │  【方式二：辅助模板，自己搜索（免费但需手动）】                  │  ┃
┃  │                                                                 │  ┃
┃  │  我已经为你准备好了搜索提示词模板，你可以复制到DeepSeek、        │  ┃
┃  │  ChatGPT等其他AI进行搜索，然后将结果保存为.md文件导入。          │  ┃
┃  │                                                                 │  ┃
┃  │  ┌─────────────────────────────────────────────────────────┐   │  ┃
┃  │  │ 请搜索并整理2015-2024年北京中考作文题目，按以下格式...   │   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  │ 1. 包含完整的题目原文                                   │   │  ┃
┃  │  │ 2. 分析每道题的主题倾向                                 │   │  ┃
┃  │  │ 3. 统计10年间的主题分布                                 │   │  ┃
┃  │  │ 4. 总结命题趋势和高分要素                               │   │  ┃
┃  │  │                                                         │   │  ┃
┃  │  │                                    [📋 复制提示词]      │   │  ┃
┃  │  └─────────────────────────────────────────────────────────┘   │  ┃
┃  │                                                                 │  ┃
┃  │  步骤：                                                           │  ┃
┃  │  1. 点击"复制提示词"                                             │  ┃
┃  │  2. 打开DeepSeek/ChatGPT等AI                                     │  ┃
┃  │  3. 粘贴提示词并发送                                             │  ┃
┃  │  4. 将AI返回的内容保存为.md文件                                  │  ┃
┃  │  5. 回到本应用，在"导入资料"页面上传该文件                        │  ┃
┃  │                                                                 │  ┃
┃  └─────────────────────────────────────────────────────────────────┘  ┃
┃                                                                       ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

**界面说明：**
- 提供两种获取真题资料的方式
- 方式一：配置API密钥后一键搜索（便捷但付费）
- 方式二：复制提示词模板，用户自己去其他AI搜索（免费但需多步操作）
- 搜索完成后自动调用Claude分析并更新知识库
```

---

## 七、可行性分析与风险提示

### 7.1 MVP可行性评估 ✅

| 功能 | 可行性 | 说明 |
|------|--------|------|
| 素材录入与存储 | ✅ 高 | LocalStorage完全满足 |
| AI评分 | ✅ 高 | Prompt工程可实现 |
| 一材多用 | ✅ 高 | AI擅长多角度分析 |
| 界面设计 | ✅ 高 | 纯CSS可实现 |

**结论：MVP版本全部功能均可实现。**

### 7.2 潜在风险 ⚠️

1. **API密钥问题**
   - 风险：用户需要自行准备Claude API密钥
   - 缓解：提供详细配置教程，考虑添加演示模式

2. **AI响应不稳定**
   - 风险：AI输出格式可能不一致
   - 缓解：严格的Prompt设计 + 输出校验 + 错误提示

3. **API费用**
   - 风险：大量使用会产生费用
   - 缓解：单次调用token控制在2000以内

### 7.3 使用前提

用户需要：
1. 注册Claude账号并获取API密钥
2. 在页面设置中填入API密钥
3. 确保浏览器支持LocalStorage

---

## 八、开发计划

### 第一阶段：MVP核心功能
1. ✅ 完成PRD设计（当前）
2. ⏳ 开发index.html（单文件应用）
   - 基础界面（输入、评分、一材多用、素材库）
   - 知识库管理界面
   - Claude API集成
   - LocalStorage存储

### 第二阶段：知识库建设
- 提供北京中考真题资料模板（给用户参考格式）
- 用户导入资料后AI分析功能
- 动态分类和评分标准更新

### 第三阶段：增强功能
- 深度拓展（历史同构、时代共鸣）
- 金句适配器
- 素材导出/备份

---

## 九、给你的建议：如何准备知识库资料

你可以从以下渠道获取北京中考真题资料：

1. **其他AI深度调研**
   - 让DeepSeek/ChatGPT/Claude等搜索2015-2024北京中考作文题目
   - 要求整理成Markdown格式：题目、类型、主题、范文

2. **教育网站**
   - 中考网、学而思、新东方等机构的真题汇总
   - 复制内容整理成.md文件

3. **格式建议**
```markdown
# 北京中考作文题目汇总 (2015-2024)

## 2024年
- 题目：_____，让我快乐
- 类型：半命题作文
- 主题：情感体验、个人成长
- 高分要点：真情实感、细节描写

## 2023年
...
```

导入后AI会自动分析并优化整个应用的分类和推荐逻辑。
